{% extends "base.html" %}

{% block content %}

<!-- カスタムCSS読み込み -->
<link rel="stylesheet" href="{{ url_for('static', filename='shiftersync/css/ss_calendar.css') }}">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<div class="min-h-screen bg-blue-100 flex items-center justify-center px-4">
  <div class="container bg-white rounded-2xl shadow-2xl p-8 w-full max-w-4xl animate-fade-in">

    <h2 class="text-3xl font-bold text-center text-blue-600 mb-6 tracking-wide">
      Shifter-Sync
    </h2>
    <h2 class="text-xl font-semibold text-center text-gray-700 mb-8">
      カレンダー生成
    </h2>

    <form method="POST" enctype="multipart/form-data" class="generator-options">
      <div class="form-group">
        <label for="csvfile">CSVファイルを選択:</label>
        <input type="file" name="csvfile" id="csvfile" accept=".csv" required>
      </div>

      <div class="form-group">
        <label for="format">出力形式を選択:</label>
        <select name="format" id="format" required>
          <option value="">選択してください</option>
          <option value="pdf">PDF (印刷用)</option>
          <option value="png">PNG (画像)</option>
        </select>
      </div>
      
      <div class="form-group">
        <button type="submit" class="generate-btn">
          <span>📅</span> カレンダー生成
        </button>
      </div>
    </form>
    
    <div class="text-center mt-6">
      <button type="button" id="backBtn" onclick="history.back()" class="back-btn">
        ← 戻る
      </button>
    </div>

    {% if image_file %}
    <div class="generated-result">
      <h3 class="result-title">✨ 生成されたカレンダー（PNG）</h3>
      <div class="image-container">
        <img src="{{ url_for('static', filename='calendar_outputs/' + image_file) }}" alt="カレンダー画像" class="calendar-image">
      </div>
      <div class="download-section">
        <a href="{{ url_for('static', filename='calendar_outputs/' + image_file) }}" download class="download-link">
          📥 PNGファイルをダウンロード
        </a>
      </div>
    </div>
    {% elif pdf_file %}
    <div class="generated-result">
      <h3 class="result-title">✨ 生成されたカレンダー（PDF）</h3>
      <div class="pdf-container">
        <embed src="{{ url_for('static', filename='calendar_outputs/' + pdf_file) }}" type="application/pdf" width="100%" height="600px" class="pdf-viewer">
      </div>
      <div class="download-section">
        <a href="{{ url_for('static', filename='calendar_outputs/' + pdf_file) }}" download class="download-link">
          📥 PDFファイルをダウンロード
        </a>
      </div>
    </div>
    {% endif %}

  </div>
</div>

{% endblock %}