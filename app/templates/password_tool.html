{% extends "base.html" %}

{% block content %}
<div class="max-w-xl mx-auto mt-10 bg-white rounded-xl shadow p-6">
  <h2 class="text-xl font-bold mb-4">🔐 パスワード生成・管理ツール</h2>

  <form action="/tools/password_tool" method="POST" class="mb-6">
    <div class="mb-4">
      <label class="block mb-1">サービス名（任意）:</label>
      <input type="text" name="label" class="w-full border rounded px-2 py-1">
    </div>

    <div class="mb-4">
      <label class="block mb-1">文字数:</label>
      <input type="number" name="length" value="12" min="4" max="64" required class="w-full border rounded px-2 py-1">
    </div>

    <div class="mb-4">
      <label><input type="checkbox" name="include_upper" checked> 英大文字を含む</label><br>
      <label><input type="checkbox" name="include_numbers" checked> 数字を含む</label><br>
      <label><input type="checkbox" name="include_symbols"> 記号を含む</label>
    </div>

    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">パスワード生成＆保存</button>
  </form>

  {% if passwords %}
    <div class="mt-6">
      <h3 class="font-semibold mb-2">🗂 保存済みパスワード一覧（セッション中）</h3>
      <div class="overflow-x-auto border rounded text-sm">
        <table class="table-auto w-full">
          <thead class="bg-gray-100">
            <tr><th class="px-2 py-1 border">サービス名</th><th class="px-2 py-1 border">パスワード</th></tr>
          </thead>
          <tbody>
            {% for item in passwords %}
              <tr>
                <td class="px-2 py-1 border">{{ item.label }}</td>
                <td class="px-2 py-1 border font-mono">{{ item.password }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

      <div class="mt-4 flex space-x-4">
      <a href="{{ url_for('password_tool.download') }}" class="text-blue-600 underline">▶ ダウンロード（CSV）</a>

      <form action="{{ url_for('password_tool.reset') }}" method="POST" onsubmit="return confirm('本当に履歴を消去しますか？');">
        <button type="submit" class="text-red-600 underline">🗑 履歴をリセット</button>
      </form>
    </div>
    {% endif %}
  </div>
{% endblock %}
